<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>طلبات الخدمات - لوحة التحكم</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #c00a27;
            --primary-dark: #8a001a;
            --primary-light: #ff4d6d;
            --secondary: #000000;
            --secondary-light: #1a1a1a;
            --light: #f5f5f5;
            --text: #333333;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
            --shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            color: var(--light);
            line-height: 1.7;
            min-height: 100vh;
        }

        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* الشريط العلوي للوحة التحكم */
        .admin-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 15px 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }

        .admin-navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 22px;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }

        .admin-user {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            text-align: left;
        }

        .user-name {
            font-weight: bold;
        }

        .user-role {
            font-size: 14px;
            opacity: 0.8;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 20px;
        }

        /* تخطيط لوحة التحكم */
        .dashboard-layout {
            display: flex;
            margin-top: 80px;
            min-height: calc(100vh - 80px);
        }

        /* الشريط الجانبي */
        .sidebar {
            width: 250px;
            background: rgba(30, 30, 30, 0.95);
            padding: 30px 0;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            position: fixed;
            right: 0;
            top: 80px;
            height: calc(100vh - 80px);
            overflow-y: auto;
        }

        .menu-title {
            padding: 15px 25px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .menu-links {
            list-style: none;
        }

        .menu-links li {
            margin-bottom: 5px;
        }

        .menu-links a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 25px;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition);
            border-right: 3px solid transparent;
        }

        .menu-links a:hover,
        .menu-links a.active {
            background: rgba(192, 10, 39, 0.1);
            color: white;
            border-right-color: var(--primary);
        }

        .menu-links a i {
            width: 20px;
            text-align: center;
        }

        /* المحتوى الرئيسي */
        .main-content {
            flex: 1;
            margin-right: 250px;
            padding: 30px;
        }

        .dashboard-header {
            margin-bottom: 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dashboard-header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 12px 24px;
            border-radius: var(--radius);
            text-decoration: none;
            font-weight: bold;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            font-size: 14px;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(192, 10, 39, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #1e7e34 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #e0a800 100%);
            color: #212529;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #bd2130 100%);
        }

        .btn-info {
            background: linear-gradient(135deg, var(--info) 0%, #117a8b 100%);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 13px;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        /* إحصائيات */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(40, 40, 40, 0.9) 0%, rgba(60, 60, 60, 0.9) 100%);
            border-radius: var(--radius);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }

        .stat-icon.new { background: var(--info); }
        .stat-icon.in-progress { background: var(--warning); }
        .stat-icon.completed { background: var(--success); }
        .stat-icon.cancelled { background: var(--danger); }

        .stat-info h3 {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        /* جدول طلبات الخدمات */
        .requests-table {
            background: linear-gradient(135deg, rgba(40, 40, 40, 0.9) 0%, rgba(60, 60, 60, 0.9) 100%);
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .table-header h2 {
            font-size: 24px;
        }

        .table-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-box {
            position: relative;
            width: 250px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius);
            color: white;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
        }

        .filter-dropdown {
            position: relative;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .filter-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: rgba(50, 50, 50, 0.95);
            border-radius: var(--radius);
            padding: 10px 0;
            min-width: 200px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .filter-menu.active {
            display: block;
        }

        .filter-option {
            padding: 12px 20px;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-option:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .filter-option.active {
            color: var(--primary);
            background: rgba(192, 10, 39, 0.1);
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: rgba(192, 10, 39, 0.1);
        }

        th, td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        th {
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        tbody tr {
            transition: var(--transition);
        }

        tbody tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .service-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
        }

        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            min-width: 100px;
        }

        .status-new { background: rgba(23, 162, 184, 0.2); color: var(--info); }
        .status-in-progress { background: rgba(255, 193, 7, 0.2); color: var(--warning); }
        .status-completed { background: rgba(40, 167, 69, 0.2); color: var(--success); }
        .status-cancelled { background: rgba(220, 53, 69, 0.2); color: var(--danger); }

        .priority-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            min-width: 80px;
        }

        .priority-low { background: rgba(40, 167, 69, 0.2); color: var(--success); }
        .priority-medium { background: rgba(255, 193, 7, 0.2); color: var(--warning); }
        .priority-high { background: rgba(220, 53, 69, 0.2); color: var(--danger); }

        .action-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        /* الشاشات المنبثقة */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: linear-gradient(135deg, rgba(40, 40, 40, 0.95) 0%, rgba(60, 60, 60, 0.95) 100%);
            border-radius: var(--radius);
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header h2 {
            font-size: 24px;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 24px;
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--primary);
        }

        .modal-body {
            padding: 30px;
        }

        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .form-control {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius);
            color: white;
            font-size: 16px;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(192, 10, 39, 0.1);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .request-details {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            padding: 25px;
            margin-bottom: 25px;
        }

        .detail-row {
            display: flex;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .detail-label {
            width: 150px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.8);
            flex-shrink: 0;
        }

        .detail-value {
            flex: 1;
            color: white;
        }

        .request-content {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            padding: 25px;
            margin-top: 20px;
        }

        .request-content h4 {
            margin-bottom: 15px;
            color: var(--primary);
        }

        .request-text {
            line-height: 1.8;
            color: rgba(255, 255, 255, 0.9);
            white-space: pre-wrap;
        }

        .notes-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .notes-list {
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius);
            padding: 20px;
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .note-item {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius);
            margin-bottom: 10px;
            border-right: 3px solid var(--primary);
        }

        .note-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
        }

        .note-text {
            color: white;
        }

        /* رسائل التأكيد */
        .confirmation-modal {
            text-align: center;
            padding: 40px 30px;
        }

        .confirmation-icon {
            font-size: 60px;
            color: var(--danger);
            margin-bottom: 20px;
        }

        .confirmation-text h3 {
            margin-bottom: 15px;
            color: white;
        }

        .confirmation-text p {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 30px;
        }

        /* تحسينات التجاوب */
        @media (max-width: 1200px) {
            .dashboard-layout {
                flex-direction: column;
            }
            
            .sidebar {
                position: relative;
                width: 100%;
                top: 0;
                height: auto;
                margin-bottom: 30px;
            }
            
            .main-content {
                margin-right: 0;
            }
        }

        @media (max-width: 992px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .table-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .search-box, .filter-dropdown {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .table-header {
                flex-direction: column;
                gap: 20px;
                align-items: stretch;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal {
                width: 95%;
                max-height: 85vh;
            }
            
            .modal-header, .modal-body, .modal-footer {
                padding: 20px;
            }
        }

        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 5px;
            }
            
            .btn-small {
                width: 100%;
            }
            
            .detail-row {
                flex-direction: column;
                gap: 5px;
            }
            
            .detail-label {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- شريط الرأس العلوي -->
    <header class="admin-header">
        <div class="container">
            <nav class="admin-navbar">
                <a href="dashboard.html" class="admin-logo">
                    <i class="fas fa-network-wired"></i>
                    <span>دوت نت - لوحة التحكم</span>
                </a>
                
                <div class="admin-user">
                    <div class="user-info">
                        <div class="user-name">أحمد محمد</div>
                        <div class="user-role">مدير النظام</div>
                    </div>
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- تخطيط لوحة التحكم -->
    <div class="dashboard-layout">
        <!-- الشريط الجانبي -->
        <aside class="sidebar">
            <div class="menu-title">القائمة الرئيسية</div>
            <ul class="menu-links">
                <li><a href="dashboard.html"><i class="fas fa-home"></i> الرئيسية</a></li>
                <li><a href="dashboard-messages.html"><i class="fas fa-envelope"></i> رسائل اتصل بنا</a></li>
                <li><a href="dashboard-services-requests.html" class="active"><i class="fas fa-tasks"></i> طلبات الخدمات</a></li>
                <li><a href="dashboard-services.html"><i class="fas fa-laptop-code"></i> الخدمات</a></li>
                <li><a href="dashboard-ads.html"><i class="fas fa-bullhorn"></i> الإعلانات</a></li>
                <li><a href="dashboard-contact.html"><i class="fas fa-address-book"></i> بيانات الاتصال</a></li>
                <li><a href="users.html"><i class="fas fa-users"></i> المستخدمين</a></li>
                <li><a href="dashboard-settings.html"><i class="fas fa-cog"></i> الإعدادات</a></li>
            </ul>
            
            <div class="menu-title">حسابات</div>
            <ul class="menu-links">
                <li><a href="index.html"><i class="fas fa-globe"></i> زيارة الموقع</a></li>
                <li><a href="#"><i class="fas fa-sign-out-alt"></i> تسجيل الخروج</a></li>
            </ul>
        </aside>

        <!-- المحتوى الرئيسي -->
        <main class="main-content">
            <div class="dashboard-header">
                <div>
                    <h1>إدارة طلبات الخدمات</h1>
                    <p>عرض وتعديل وإدارة جميع طلبات الخدمات المقدمة من العملاء</p>
                </div>
                <button class="btn" onclick="openAddModal()">
                    <i class="fas fa-plus"></i> إضافة طلب جديد
                </button>
            </div>

            <!-- إحصائيات -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon new">
                        <i class="fas fa-plus-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>طلبات جديدة</h3>
                        <div class="stat-number" id="newCount">0</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon in-progress">
                        <i class="fas fa-spinner"></i>
                    </div>
                    <div class="stat-info">
                        <h3>قيد التنفيذ</h3>
                        <div class="stat-number" id="inProgressCount">0</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon completed">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>منتهية</h3>
                        <div class="stat-number" id="completedCount">0</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon cancelled">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3>ملغاة</h3>
                        <div class="stat-number" id="cancelledCount">0</div>
                    </div>
                </div>
            </div>

            <!-- جدول طلبات الخدمات -->
            <div class="requests-table">
                <div class="table-header">
                    <h2>قائمة طلبات الخدمات</h2>
                    <div class="table-controls">
                        <div class="search-box">
                            <input type="text" id="searchInput" placeholder="بحث في الطلبات...">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="filter-dropdown">
                            <button class="filter-btn" onclick="toggleFilterMenu()">
                                <i class="fas fa-filter"></i>
                                <span id="filterText">جميع الطلبات</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="filter-menu" id="filterMenu">
                                <div class="filter-option active" data-filter="all">جميع الطلبات</div>
                                <div class="filter-option" data-filter="new">طلبات جديدة</div>
                                <div class="filter-option" data-filter="in-progress">قيد التنفيذ</div>
                                <div class="filter-option" data-filter="completed">منتهية</div>
                                <div class="filter-option" data-filter="cancelled">ملغاة</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th width="60">#</th>
                                <th>اسم العميل</th>
                                <th>نوع الخدمة</th>
                                <th>تاريخ الطلب</th>
                                <th>الحالة</th>
                                <th>الأولوية</th>
                                <th>المسؤول</th>
                                <th width="200">الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="requestsTableBody">
                            <!-- سيتم ملء الجدول بالبيانات من JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- الشاشات المنبثقة -->

    <!-- شاشة عرض تفاصيل الطلب -->
    <div class="modal-overlay" id="viewModal">
        <div class="modal">
            <div class="modal-header">
                <h2>تفاصيل طلب الخدمة</h2>
                <button class="modal-close" onclick="closeModal('viewModal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="request-details">
                    <div class="detail-row">
                        <span class="detail-label">رقم الطلب:</span>
                        <span class="detail-value" id="viewRequestId">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">اسم العميل:</span>
                        <span class="detail-value" id="viewClientName">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">البريد الإلكتروني:</span>
                        <span class="detail-value" id="viewClientEmail">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">رقم الهاتف:</span>
                        <span class="detail-value" id="viewClientPhone">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">نوع الخدمة:</span>
                        <span class="detail-value" id="viewServiceType">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">تاريخ الطلب:</span>
                        <span class="detail-value" id="viewRequestDate">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">حالة الطلب:</span>
                        <span class="detail-value">
                            <span class="status-badge" id="viewStatus">جديد</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">أولوية الطلب:</span>
                        <span class="detail-value">
                            <span class="priority-badge" id="viewPriority">متوسطة</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">المسؤول عن الطلب:</span>
                        <span class="detail-value" id="viewAssignedTo">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">تاريخ التسليم المتوقع:</span>
                        <span class="detail-value" id="viewDeliveryDate">-</span>
                    </div>
                </div>
                
                <div class="request-content">
                    <h4>تفاصيل الطلب:</h4>
                    <div class="request-text" id="viewRequestDetails">-</div>
                </div>
                
                <div class="notes-section">
                    <h4>الملاحظات والتحديثات:</h4>
                    <div class="notes-list" id="viewNotesList">
                        <!-- سيتم ملء الملاحظات من JavaScript -->
                    </div>
                    <div class="form-group" style="margin-top: 20px;">
                        <label>إضافة ملاحظة جديدة:</label>
                        <textarea id="newNote" class="form-control" rows="3" placeholder="أضف ملاحظة أو تحديث حول حالة الطلب..."></textarea>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-success" onclick="updateRequestStatus('in-progress')">
                    <i class="fas fa-play-circle"></i> بدء التنفيذ
                </button>
                <button class="btn btn-info" onclick="updateRequestStatus('completed')">
                    <i class="fas fa-check-circle"></i> إكمال الطلب
                </button>
                <button class="btn btn-warning" onclick="openEditModal()">
                    <i class="fas fa-edit"></i> تعديل الطلب
                </button>
                <button class="btn btn-danger" onclick="openDeleteModal()">
                    <i class="fas fa-trash"></i> حذف الطلب
                </button>
            </div>
        </div>
    </div>
    
    <!-- شاشة إضافة طلب جديد -->
    <div class="modal-overlay" id="addModal">
        <div class="modal">
            <div class="modal-header">
                <h2>إضافة طلب خدمة جديد</h2>
                <button class="modal-close" onclick="closeModal('addModal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <form id="addRequestForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="addClientName">اسم العميل *</label>
                            <input type="text" id="addClientName" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="addClientEmail">البريد الإلكتروني *</label>
                            <input type="email" id="addClientEmail" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="addClientPhone">رقم الهاتف</label>
                            <input type="tel" id="addClientPhone" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="addServiceType">نوع الخدمة *</label>
                            <select id="addServiceType" class="form-control" required>
                                <option value="">اختر نوع الخدمة</option>
                                <option value="website">تصميم موقع ويب</option>
                                <option value="mobile">تطبيق جوال</option>
                                <option value="ecommerce">متجر إلكتروني</option>
                                <option value="marketing">تسويق رقمي</option>
                                <option value="erp">نظام ERP</option>
                                <option value="maintenance">صيانة وتحديث</option>
                                <option value="consultation">استشارة تقنية</option>
                                <option value="other">خدمات أخرى</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="addStatus">حالة الطلب *</label>
                            <select id="addStatus" class="form-control" required>
                                <option value="new">جديد</option>
                                <option value="in-progress">قيد التنفيذ</option>
                                <option value="completed">منتهي</option>
                                <option value="cancelled">ملغي</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="addPriority">الأولوية *</label>
                            <select id="addPriority" class="form-control" required>
                                <option value="low">منخفضة</option>
                                <option value="medium" selected>متوسطة</option>
                                <option value="high">عالية</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="addAssignedTo">تعيين للمسؤول</label>
                            <select id="addAssignedTo" class="form-control">
                                <option value="">غير معين</option>
                                <option value="أحمد محمد">أحمد محمد</option>
                                <option value="سارة عبدالله">سارة عبدالله</option>
                                <option value="خالد الرشيد">خالد الرشيد</option>
                                <option value="نورة القحطاني">نورة القحطاني</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="addDeliveryDate">تاريخ التسليم المتوقع</label>
                            <input type="date" id="addDeliveryDate" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="addRequestDetails">تفاصيل الطلب *</label>
                        <textarea id="addRequestDetails" class="form-control" rows="6" required placeholder="اكتب تفاصيل طلب الخدمة هنا..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="addNotes">ملاحظات أولية (اختياري)</label>
                        <textarea id="addNotes" class="form-control" rows="3" placeholder="ملاحظات إضافية حول الطلب..."></textarea>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-success" onclick="saveNewRequest()">
                    <i class="fas fa-save"></i> حفظ الطلب
                </button>
                <button class="btn btn-outline" onclick="closeModal('addModal')">
                    <i class="fas fa-times"></i> إلغاء
                </button>
            </div>
        </div>
    </div>
    
    <!-- شاشة تعديل الطلب -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <div class="modal-header">
                <h2>تعديل طلب الخدمة</h2>
                <button class="modal-close" onclick="closeModal('editModal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <form id="editRequestForm">
                    <input type="hidden" id="editRequestId">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editClientName">اسم العميل *</label>
                            <input type="text" id="editClientName" class="form-control" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="editClientEmail">البريد الإلكتروني *</label>
                            <input type="email" id="editClientEmail" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editClientPhone">رقم الهاتف</label>
                            <input type="tel" id="editClientPhone" class="form-control">
                        </div>
                        
                        <div class="form-group">
                            <label for="editServiceType">نوع الخدمة *</label>
                            <select id="editServiceType" class="form-control" required>
                                <option value="">اختر نوع الخدمة</option>
                                <option value="website">تصميم موقع ويب</option>
                                <option value="mobile">تطبيق جوال</option>
                                <option value="ecommerce">متجر إلكتروني</option>
                                <option value="marketing">تسويق رقمي</option>
                                <option value="erp">نظام ERP</option>
                                <option value="maintenance">صيانة وتحديث</option>
                                <option value="consultation">استشارة تقنية</option>
                                <option value="other">خدمات أخرى</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editStatus">حالة الطلب *</label>
                            <select id="editStatus" class="form-control" required>
                                <option value="new">جديد</option>
                                <option value="in-progress">قيد التنفيذ</option>
                                <option value="completed">منتهي</option>
                                <option value="cancelled">ملغي</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="editPriority">الأولوية *</label>
                            <select id="editPriority" class="form-control" required>
                                <option value="low">منخفضة</option>
                                <option value="medium">متوسطة</option>
                                <option value="high">عالية</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editAssignedTo">تعيين للمسؤول</label>
                            <select id="editAssignedTo" class="form-control">
                                <option value="">غير معين</option>
                                <option value="أحمد محمد">أحمد محمد</option>
                                <option value="سارة عبدالله">سارة عبدالله</option>
                                <option value="خالد الرشيد">خالد الرشيد</option>
                                <option value="نورة القحطاني">نورة القحطاني</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="editDeliveryDate">تاريخ التسليم المتوقع</label>
                            <input type="date" id="editDeliveryDate" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="editRequestDetails">تفاصيل الطلب *</label>
                        <textarea id="editRequestDetails" class="form-control" rows="6" required></textarea>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-success" onclick="saveEditRequest()">
                    <i class="fas fa-save"></i> حفظ التعديلات
                </button>
                <button class="btn btn-danger" onclick="openDeleteModal()">
                    <i class="fas fa-trash"></i> حذف الطلب
                </button>
                <button class="btn btn-outline" onclick="closeModal('editModal')">
                    <i class="fas fa-times"></i> إلغاء
                </button>
            </div>
        </div>
    </div>
    
    <!-- شاشة تأكيد الحذف -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <div class="modal-header">
                <h2>تأكيد حذف الطلب</h2>
                <button class="modal-close" onclick="closeModal('deleteModal')">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="confirmation-modal">
                    <div class="confirmation-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="confirmation-text">
                        <h3>هل أنت متأكد من حذف طلب الخدمة هذا؟</h3>
                        <p>هذا الإجراء لا يمكن التراجع عنه. سيتم حذف جميع البيانات المرتبطة بهذا الطلب بما في ذلك الملاحظات والتحديثات.</p>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-danger" onclick="confirmDelete()">
                    <i class="fas fa-trash"></i> نعم، احذف الطلب
                </button>
                <button class="btn btn-outline" onclick="closeModal('deleteModal')">
                    <i class="fas fa-times"></i> إلغاء
                </button>
            </div>
        </div>
    </div>

    <script>
        // بيانات تجريبية لطلبات الخدمات
        let serviceRequests = [
            {
                id: 1001,
                clientName: "محمد أحمد",
                clientEmail: "mohamed@example.com",
                clientPhone: "+966501234567",
                serviceType: "website",
                serviceTypeText: "تصميم موقع ويب",
                requestDate: "2023-10-15",
                status: "new",
                priority: "high",
                assignedTo: "أحمد محمد",
                deliveryDate: "2023-12-01",
                requestDetails: "أحتاج إلى تصميم موقع ويب لشركتي الناشئة في مجال التجارة الإلكترونية. الموقع يجب أن يكون متجاوباً مع جميع الأجهزة ويحتوي على نظام إدارة محتوى متكامل.",
                notes: [
                    {
                        id: 1,
                        text: "تم التواصل مع العميل لتوضيح المتطلبات",
                        date: "2023-10-16",
                        author: "أحمد محمد"
                    }
                ]
            },
            {
                id: 1002,
                clientName: "نورة السعيد",
                clientEmail: "nora@example.com",
                clientPhone: "+966552345678",
                serviceType: "mobile",
                serviceTypeText: "تطبيق جوال",
                requestDate: "2023-10-14",
                status: "in-progress",
                priority: "medium",
                assignedTo: "سارة عبدالله",
                deliveryDate: "2023-11-30",
                requestDetails: "تطبيق جوال لمتجر إلكتروني يعمل على أنظمة iOS و Android. يحتوي على نظام دفع إلكتروني وتتبع الطلبات.",
                notes: [
                    {
                        id: 1,
                        text: "بدأ فريق التطوير في تحليل المتطلبات",
                        date: "2023-10-15",
                        author: "سارة عبدالله"
                    },
                    {
                        id: 2,
                        text: "تم إرسال نموذج أولي للعميل",
                        date: "2023-10-18",
                        author: "سارة عبدالله"
                    }
                ]
            },
            {
                id: 1003,
                clientName: "خالد الراشد",
                clientEmail: "khalid@example.com",
                clientPhone: "+966503456789",
                serviceType: "erp",
                serviceTypeText: "نظام ERP",
                requestDate: "2023-10-10",
                status: "completed",
                priority: "high",
                assignedTo: "خالد الرشيد",
                deliveryDate: "2023-10-25",
                requestDetails: "تطوير نظام إدارة موارد المؤسسات لشركة مقاولات. يشمل إدارة المشاريع والمخازن والموارد البشرية.",
                notes: [
                    {
                        id: 1,
                        text: "تم تسليم النظام للعميل",
                        date: "2023-10-25",
                        author: "خالد الرشيد"
                    },
                    {
                        id: 2,
                        text: "العميل راضٍ عن الأداء",
                        date: "2023-10-28",
                        author: "خالد الرشيد"
                    }
                ]
            }
        ];

        let currentRequestId = null;
        let currentFilter = 'all';

        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            loadServiceRequests();
            updateStats();
            setupEventListeners();
        });

        // تحميل طلبات الخدمات في الجدول
        function loadServiceRequests(filter = 'all') {
            const tbody = document.getElementById('requestsTableBody');
            tbody.innerHTML = '';
            
            let filteredRequests = [...serviceRequests];
            
            if (filter !== 'all') {
                filteredRequests = serviceRequests.filter(request => request.status === filter);
            }
            
            // ترتيب حسب التاريخ (الأحدث أولاً)
            filteredRequests.sort((a, b) => new Date(b.requestDate) - new Date(a.requestDate));
            
            filteredRequests.forEach(request => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${request.id}</td>
                    <td>${request.clientName}</td>
                    <td><span class="service-badge">${request.serviceTypeText}</span></td>
                    <td>${request.requestDate}</td>
                    <td><span class="status-badge status-${request.status}">${getStatusText(request.status)}</span></td>
                    <td><span class="priority-badge priority-${request.priority}">${getPriorityText(request.priority)}</span></td>
                    <td>${request.assignedTo || 'غير معين'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-small btn-info" onclick="viewRequest(${request.id})">
                                <i class="fas fa-eye"></i> عرض
                            </button>
                            <button class="btn btn-small btn-warning" onclick="openEditRequestModal(${request.id})">
                                <i class="fas fa-edit"></i> تعديل
                            </button>
                            <button class="btn btn-small btn-danger" onclick="openDeleteConfirmation(${request.id})">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // تحديث الإحصائيات
            updateStats();
        }

        // الحصول على نص الحالة
        function getStatusText(status) {
            const statusMap = {
                'new': 'جديد',
                'in-progress': 'قيد التنفيذ',
                'completed': 'منتهي',
                'cancelled': 'ملغي'
            };
            return statusMap[status] || status;
        }

        // الحصول على نص الأولوية
        function getPriorityText(priority) {
            const priorityMap = {
                'low': 'منخفضة',
                'medium': 'متوسطة',
                'high': 'عالية'
            };
            return priorityMap[priority] || priority;
        }

        // الحصول على نص نوع الخدمة
        function getServiceTypeText(type) {
            const typeMap = {
                'website': 'تصميم موقع ويب',
                'mobile': 'تطبيق جوال',
                'ecommerce': 'متجر إلكتروني',
                'marketing': 'تسويق رقمي',
                'erp': 'نظام ERP',
                'maintenance': 'صيانة وتحديث',
                'consultation': 'استشارة تقنية',
                'other': 'خدمات أخرى'
            };
            return typeMap[type] || type;
        }

        // إعداد مستمعي الأحداث
        function setupEventListeners() {
            // البحث
            document.getElementById('searchInput').addEventListener('input', function(e) {
                searchRequests(e.target.value);
            });
            
            // مرشحات القائمة
            document.querySelectorAll('.filter-option').forEach(option => {
                option.addEventListener('click', function() {
                    const filter = this.dataset.filter;
                    
                    // تحديث القائمة المفتوحة
                    document.querySelectorAll('.filter-option').forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    
                    // تحديث النص الظاهر
                    document.getElementById('filterText').textContent = this.textContent;
                    
                    // إغلاق القائمة
                    document.getElementById('filterMenu').classList.remove('active');
                    
                    // تحميل البيانات
                    currentFilter = filter;
                    loadServiceRequests(filter);
                });
            });
        }

        // تحديث الإحصائيات
        function updateStats() {
            const newCount = serviceRequests.filter(req => req.status === 'new').length;
            const inProgressCount = serviceRequests.filter(req => req.status === 'in-progress').length;
            const completedCount = serviceRequests.filter(req => req.status === 'completed').length;
            const cancelledCount = serviceRequests.filter(req => req.status === 'cancelled').length;
            
            document.getElementById('newCount').textContent = newCount;
            document.getElementById('inProgressCount').textContent = inProgressCount;
            document.getElementById('completedCount').textContent = completedCount;
            document.getElementById('cancelledCount').textContent = cancelledCount;
        }

        // البحث في الطلبات
        function searchRequests(query) {
            const rows = document.querySelectorAll('#requestsTableBody tr');
            const searchTerm = query.toLowerCase();
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // تبديل قائمة المرشحات
        function toggleFilterMenu() {
            const menu = document.getElementById('filterMenu');
            menu.classList.toggle('active');
        }

        // عرض تفاصيل الطلب
        function viewRequest(id) {
            const request = serviceRequests.find(req => req.id === id);
            if (!request) return;
            
            currentRequestId = id;
            
            // تعبئة البيانات في الشاشة المنبثقة
            document.getElementById('viewRequestId').textContent = request.id;
            document.getElementById('viewClientName').textContent = request.clientName;
            document.getElementById('viewClientEmail').textContent = request.clientEmail;
            document.getElementById('viewClientPhone').textContent = request.clientPhone;
            document.getElementById('viewServiceType').textContent = request.serviceTypeText;
            document.getElementById('viewRequestDate').textContent = request.requestDate;
            document.getElementById('viewRequestDetails').textContent = request.requestDetails;
            document.getElementById('viewAssignedTo').textContent = request.assignedTo || 'غير معين';
            document.getElementById('viewDeliveryDate').textContent = request.deliveryDate || '-';
            
            // تحديث الحالة والأولوية
            const statusElement = document.getElementById('viewStatus');
            statusElement.textContent = getStatusText(request.status);
            statusElement.className = `status-badge status-${request.status}`;
            
            const priorityElement = document.getElementById('viewPriority');
            priorityElement.textContent = getPriorityText(request.priority);
            priorityElement.className = `priority-badge priority-${request.priority}`;
            
            // تحميل الملاحظات
            loadNotes(request.notes);
            
            openModal('viewModal');
        }

        // تحميل الملاحظات
        function loadNotes(notes) {
            const notesList = document.getElementById('viewNotesList');
            notesList.innerHTML = '';
            
            if (!notes || notes.length === 0) {
                notesList.innerHTML = '<p style="text-align: center; color: rgba(255,255,255,0.5);">لا توجد ملاحظات</p>';
                return;
            }
            
            // ترتيب الملاحظات (الأحدث أولاً)
            notes.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            notes.forEach(note => {
                const noteElement = document.createElement('div');
                noteElement.className = 'note-item';
                noteElement.innerHTML = `
                    <div class="note-header">
                        <span>${note.author}</span>
                        <span>${note.date}</span>
                    </div>
                    <div class="note-text">${note.text}</div>
                `;
                notesList.appendChild(noteElement);
            });
        }

        // فتح شاشة إضافة طلب جديد
        function openAddModal() {
            // تفريغ النموذج
            document.getElementById('addRequestForm').reset();
            
            // تعيين التاريخ الحالي لتاريخ التسليم المتوقع (بعد أسبوع)
            const nextWeek = new Date();
            nextWeek.setDate(nextWeek.getDate() + 7);
            document.getElementById('addDeliveryDate').value = nextWeek.toISOString().split('T')[0];
            
            openModal('addModal');
        }

        // حفظ طلب جديد
        function saveNewRequest() {
            const clientName = document.getElementById('addClientName').value;
            const clientEmail = document.getElementById('addClientEmail').value;
            const clientPhone = document.getElementById('addClientPhone').value;
            const serviceType = document.getElementById('addServiceType').value;
            const status = document.getElementById('addStatus').value;
            const priority = document.getElementById('addPriority').value;
            const assignedTo = document.getElementById('addAssignedTo').value;
            const deliveryDate = document.getElementById('addDeliveryDate').value;
            const requestDetails = document.getElementById('addRequestDetails').value;
            const notesText = document.getElementById('addNotes').value;
            
            // التحقق من البيانات
            if (!clientName || !clientEmail || !serviceType || !requestDetails) {
                alert('يرجى ملء جميع الحقول المطلوبة!');
                return;
            }
            
            // إنشاء الملاحظات
            const notes = [];
            if (notesText.trim()) {
                notes.push({
                    id: 1,
                    text: notesText,
                    date: new Date().toISOString().split('T')[0],
                    author: 'أحمد محمد' // يمكن تغييره ليكون المستخدم الحالي
                });
            }
            
            const newRequest = {
                id: serviceRequests.length > 0 ? Math.max(...serviceRequests.map(r => r.id)) + 1 : 1001,
                clientName: clientName,
                clientEmail: clientEmail,
                clientPhone: clientPhone,
                serviceType: serviceType,
                serviceTypeText: getServiceTypeText(serviceType),
                requestDate: new Date().toISOString().split('T')[0],
                status: status,
                priority: priority,
                assignedTo: assignedTo || null,
                deliveryDate: deliveryDate || null,
                requestDetails: requestDetails,
                notes: notes
            };
            
            serviceRequests.unshift(newRequest);
            
            // إعادة تحميل الجدول
            loadServiceRequests(currentFilter);
            
            // إغلاق الشاشة المنبثقة
            closeModal('addModal');
            
            // إظهار رسالة النجاح
            alert('تم إضافة طلب الخدمة بنجاح!');
        }

        // فتح شاشة تعديل الطلب
        function openEditRequestModal(id) {
            const request = serviceRequests.find(req => req.id === id);
            if (!request) return;
            
            currentRequestId = id;
            
            // تعبئة البيانات في النموذج
            document.getElementById('editRequestId').value = request.id;
            document.getElementById('editClientName').value = request.clientName;
            document.getElementById('editClientEmail').value = request.clientEmail;
            document.getElementById('editClientPhone').value = request.clientPhone || '';
            document.getElementById('editServiceType').value = request.serviceType;
            document.getElementById('editStatus').value = request.status;
            document.getElementById('editPriority').value = request.priority;
            document.getElementById('editAssignedTo').value = request.assignedTo || '';
            document.getElementById('editDeliveryDate').value = request.deliveryDate || '';
            document.getElementById('editRequestDetails').value = request.requestDetails;
            
            openModal('editModal');
        }

        // حفظ التعديلات
        function saveEditRequest() {
            const id = parseInt(document.getElementById('editRequestId').value);
            const index = serviceRequests.findIndex(req => req.id === id);
            
            if (index === -1) return;
            
            const updatedRequest = {
                ...serviceRequests[index],
                clientName: document.getElementById('editClientName').value,
                clientEmail: document.getElementById('editClientEmail').value,
                clientPhone: document.getElementById('editClientPhone').value,
                serviceType: document.getElementById('editServiceType').value,
                serviceTypeText: getServiceTypeText(document.getElementById('editServiceType').value),
                status: document.getElementById('editStatus').value,
                priority: document.getElementById('editPriority').value,
                assignedTo: document.getElementById('editAssignedTo').value || null,
                deliveryDate: document.getElementById('editDeliveryDate').value || null,
                requestDetails: document.getElementById('editRequestDetails').value
            };
            
            // التحقق من البيانات
            if (!updatedRequest.clientName || !updatedRequest.clientEmail || 
                !updatedRequest.serviceType || !updatedRequest.requestDetails) {
                alert('يرجى ملء جميع الحقول المطلوبة!');
                return;
            }
            
            serviceRequests[index] = updatedRequest;
            
            // إعادة تحميل الجدول
            loadServiceRequests(currentFilter);
            
            // إغلاق الشاشة المنبثقة
            closeModal('editModal');
            
            // إظهار رسالة النجاح
            alert('تم حفظ التعديلات بنجاح!');
        }

        // تحديث حالة الطلب
        function updateRequestStatus(newStatus) {
            const index = serviceRequests.findIndex(req => req.id === currentRequestId);
            
            if (index === -1) return;
            
            serviceRequests[index].status = newStatus;
            
            // إضافة ملاحظة تلقائية
            const noteText = document.getElementById('newNote').value.trim();
            if (noteText) {
                const newNote = {
                    id: serviceRequests[index].notes.length + 1,
                    text: noteText,
                    date: new Date().toISOString().split('T')[0],
                    author: 'أحمد محمد'
                };
                serviceRequests[index].notes.push(newNote);
                document.getElementById('newNote').value = '';
            }
            
            // تحديث عرض الطلب
            viewRequest(currentRequestId);
            
            // إعادة تحميل الجدول
            loadServiceRequests(currentFilter);
            
            // إظهار رسالة النجاح
            alert(`تم تحديث حالة الطلب إلى "${getStatusText(newStatus)}" بنجاح!`);
        }

        // فتح شاشة تأكيد الحذف
        function openDeleteConfirmation(id) {
            currentRequestId = id;
            openModal('deleteModal');
        }

        // فتح شاشة حذف من شاشة التعديل
        function openDeleteModal() {
            closeModal('editModal');
            openModal('deleteModal');
        }

        // تأكيد الحذف
        function confirmDelete() {
            const index = serviceRequests.findIndex(req => req.id === currentRequestId);
            
            if (index !== -1) {
                const clientName = serviceRequests[index].clientName;
                serviceRequests.splice(index, 1);
                
                // إعادة تحميل الجدول
                loadServiceRequests(currentFilter);
                
                // إغلاق الشاشة المنبثقة
                closeModal('deleteModal');
                closeModal('viewModal');
                closeModal('editModal');
                
                // إظهار رسالة النجاح
                alert(`تم حذف طلب الخدمة للعميل "${clientName}" بنجاح!`);
            }
        }

        // فتح شاشة التعديل من شاشة العرض
        function openEditModal() {
            closeModal('viewModal');
            openEditRequestModal(currentRequestId);
        }

        // فتح الشاشة المنبثقة
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // إغلاق الشاشة المنبثقة
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // النقر خارج الشاشة المنبثقة لإغلاقها
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) {
                    const modalId = this.id;
                    closeModal(modalId);
                }
            });
        });

        // إغلاق قائمة المرشحات عند النقر خارجها
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.filter-dropdown')) {
                document.getElementById('filterMenu').classList.remove('active');
            }
        });
    </script>
</body>
</html>